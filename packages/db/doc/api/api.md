<!--- Code generated by @the-/script-doc. DO NOT EDIT. -->

<a name="module_@the-/db"></a>

## @the-/db
DB for the-framework

**Version**: 21.0.5  
**License**: MIT  

* [@the-/db](#module_@the-/db)
    * _static_
        * [.TheDBBase](#module_@the-/db.TheDBBase)
        * [.TheDB](#module_@the-/db.TheDB) ⇐ [<code>CascadeMixed</code>](#module_@the-/db.cascadeMix..CascadeMixed)
            * [new TheDB(config)](#new_module_@the-/db.TheDB_new)
            * [.requestToRefresh(entityRef)](#module_@the-/db.refreshMix..RefreshMixed+requestToRefresh)
            * [.startRefreshLoop(interval)](#module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop)
            * [.stopRefreshLoop()](#module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop)
            * [.waitToRefresh(entityRef, [options])](#module_@the-/db.refreshMix..RefreshMixed+waitToRefresh) ⇒ <code>Promise.&lt;boolean&gt;</code>
            * [.assertResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+assertResource)
            * [.getResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+getResource) ⇒ <code>Object</code>
            * [.hasResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+hasResource) ⇒ <code>boolean</code>
        * [.TheLogResource](#module_@the-/db.TheLogResource)
            * [new TheLogResource()](#new_module_@the-/db.TheLogResource_new)
        * [.TheSchemaResource](#module_@the-/db.TheSchemaResource)
            * [new TheSchemaResource()](#new_module_@the-/db.TheSchemaResource_new)
        * [.helpers](#module_@the-/db.helpers) : <code>object</code>
            * [.binder](#module_@the-/db.helpers.binder) : <code>object</code>
            * [.createTerminal(handler, [options&#x3D;])](#module_@the-/db.helpers.createTerminal) ⇒ <code>Promise.&lt;\*&gt;</code>
            * [.execMysql(env, sqls)](#module_@the-/db.helpers.execMysql)
            * [.execSqlite(env, sql, [options&#x3D;])](#module_@the-/db.helpers.execSqlite) ⇒ <code>Promise.&lt;\*&gt;</code>
        * [.mixins](#module_@the-/db.mixins) : <code>object</code>
        * [.resources](#module_@the-/db.resources) : <code>object</code>
        * [.create(...args)](#module_@the-/db.create) ⇒ [<code>TheDB</code>](#module_@the-/db.TheDB)
        * [.default()](#module_@the-/db.default)
        * [.driverFromEnv(env, options)](#module_@the-/db.driverFromEnv) ⇒ <code>\*</code>
        * [.execForEnv(env, sql)](#module_@the-/db.execForEnv) ⇒ <code>Promise.&lt;\*&gt;</code>
        * [.setupForEnv(env)](#module_@the-/db.setupForEnv) ⇒ <code>Promise.&lt;\*&gt;</code>
        * [.cascadeMix(Class)](#module_@the-/db.cascadeMix) ⇒ <code>function</code>
            * [~CascadeMixed](#module_@the-/db.cascadeMix..CascadeMixed)
        * [.cliMix(Class)](#module_@the-/db.cliMix) ⇒ <code>\*</code>
            * [~CliMixed](#module_@the-/db.cliMix..CliMixed)
        * [.migrateMix()](#module_@the-/db.migrateMix) ⇒ <code>function</code>
        * [.refreshMix(Class)](#module_@the-/db.refreshMix) ⇒ <code>function</code>
            * [~RefreshMixed](#module_@the-/db.refreshMix..RefreshMixed)
                * [.requestToRefresh(entityRef)](#module_@the-/db.refreshMix..RefreshMixed+requestToRefresh)
                * [.startRefreshLoop(interval)](#module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop)
                * [.stopRefreshLoop()](#module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop)
                * [.waitToRefresh(entityRef, [options])](#module_@the-/db.refreshMix..RefreshMixed+waitToRefresh) ⇒ <code>Promise.&lt;boolean&gt;</code>
        * [.resourceMix(Class)](#module_@the-/db.resourceMix) ⇒ <code>\*</code>
            * [~ResourceMixed](#module_@the-/db.resourceMix..ResourceMixed)
                * [.assertResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+assertResource)
                * [.getResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+getResource) ⇒ <code>Object</code>
                * [.hasResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+hasResource) ⇒ <code>boolean</code>
    * _inner_
        * [~MigrateMixed](#module_@the-/db..MigrateMixed)
            * [.migrate(handlers)](#module_@the-/db..MigrateMixed+migrate) ⇒ <code>Promise.&lt;?Object&gt;</code>

<a name="module_@the-/db.TheDBBase"></a>

### db.TheDBBase
**Kind**: static class of [<code>@the-/db</code>](#module_@the-/db)  
<a name="module_@the-/db.TheDB"></a>

### db.TheDB ⇐ [<code>CascadeMixed</code>](#module_@the-/db.cascadeMix..CascadeMixed)
**Kind**: static class of [<code>@the-/db</code>](#module_@the-/db)  
**Extends**: [<code>CascadeMixed</code>](#module_@the-/db.cascadeMix..CascadeMixed), [<code>CliMixed</code>](#module_@the-/db.cliMix..CliMixed), <code>module:@the-/db.migrateMix~MigrateMixed</code>, [<code>RefreshMixed</code>](#module_@the-/db.refreshMix..RefreshMixed), [<code>ResourceMixed</code>](#module_@the-/db.resourceMix..ResourceMixed)  

* [.TheDB](#module_@the-/db.TheDB) ⇐ [<code>CascadeMixed</code>](#module_@the-/db.cascadeMix..CascadeMixed)
    * [new TheDB(config)](#new_module_@the-/db.TheDB_new)
    * [.requestToRefresh(entityRef)](#module_@the-/db.refreshMix..RefreshMixed+requestToRefresh)
    * [.startRefreshLoop(interval)](#module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop)
    * [.stopRefreshLoop()](#module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop)
    * [.waitToRefresh(entityRef, [options])](#module_@the-/db.refreshMix..RefreshMixed+waitToRefresh) ⇒ <code>Promise.&lt;boolean&gt;</code>
    * [.assertResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+assertResource)
    * [.getResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+getResource) ⇒ <code>Object</code>
    * [.hasResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+hasResource) ⇒ <code>boolean</code>

<a name="new_module_@the-/db.TheDB_new"></a>

#### new TheDB(config)

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| config | <code>Object</code> |  |  |
| [config.name] | <code>string</code> | <code>&quot;uuid()&quot;</code> | Name of clay-lump |
| [config.dialect] | <code>string</code> | <code>&quot;&#x27;memory&#x27;&quot;</code> | Database dialect. "mysql", "json", "memory", "localstorage", or "sqlite" |
| [config.storage] | <code>string</code> |  | Storage file name for "sqlite" or "json" dialect |
| [config.database] | <code>string</code> |  | Name of database schema |
| [config.username] | <code>string</code> |  | Database username |
| [config.password] | <code>string</code> |  | Database password |
| [config.host] | <code>string</code> |  | Database password |
| [config.port] | <code>string</code> |  | Database password |
| [config.plugins] | <code>Object</code> |  | Database plugin creators |
| [config.hooks] | <code>Object</code> |  | Database hook creators |
| [config.resources] | <code>Object</code> |  | Database resource classes |
| [config.enableLegacyEncoding] | <code>boolean</code> |  | Encode string with utf8 before saving to support the old version |

<a name="module_@the-/db.refreshMix..RefreshMixed+requestToRefresh"></a>

#### theDB.requestToRefresh(entityRef)
Request to refresh entity

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  

| Param | Type |
| --- | --- |
| entityRef | <code>string</code> | 

<a name="module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop"></a>

#### theDB.startRefreshLoop(interval)
Start refreshing loop

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  

| Param | Type |
| --- | --- |
| interval | <code>number</code> | 

<a name="module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop"></a>

#### theDB.stopRefreshLoop()
Stop refreshing loop

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  
<a name="module_@the-/db.refreshMix..RefreshMixed+waitToRefresh"></a>

#### theDB.waitToRefresh(entityRef, [options]) ⇒ <code>Promise.&lt;boolean&gt;</code>
Wait until refresh

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  
**Returns**: <code>Promise.&lt;boolean&gt;</code> - - Full filled  

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| entityRef | <code>string</code> |  |  |
| [options] | <code>Object</code> | <code>{}</code> | Optional settings |

<a name="module_@the-/db.resourceMix..ResourceMixed+assertResource"></a>

#### theDB.assertResource(resourceName)
Check if resource exists

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  
**Throws**:

- <code>Error</code> Resource not found error


| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db.resourceMix..ResourceMixed+getResource"></a>

#### theDB.getResource(resourceName) ⇒ <code>Object</code>
Get resource with name

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  
**Returns**: <code>Object</code> - Resource instance  

| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db.resourceMix..ResourceMixed+hasResource"></a>

#### theDB.hasResource(resourceName) ⇒ <code>boolean</code>
Check if resource exists

**Kind**: instance method of [<code>TheDB</code>](#module_@the-/db.TheDB)  

| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db.TheLogResource"></a>

### db.TheLogResource
**Kind**: static class of [<code>@the-/db</code>](#module_@the-/db)  
<a name="new_module_@the-/db.TheLogResource_new"></a>

#### new TheLogResource()
Resource of data history

<a name="module_@the-/db.TheSchemaResource"></a>

### db.TheSchemaResource
**Kind**: static class of [<code>@the-/db</code>](#module_@the-/db)  
<a name="new_module_@the-/db.TheSchemaResource_new"></a>

#### new TheSchemaResource()
Resource to manage schema

<a name="module_@the-/db.helpers"></a>

### db.helpers : <code>object</code>
Helper functions

**Kind**: static namespace of [<code>@the-/db</code>](#module_@the-/db)  
**Access**: protected  

* [.helpers](#module_@the-/db.helpers) : <code>object</code>
    * [.binder](#module_@the-/db.helpers.binder) : <code>object</code>
    * [.createTerminal(handler, [options&#x3D;])](#module_@the-/db.helpers.createTerminal) ⇒ <code>Promise.&lt;\*&gt;</code>
    * [.execMysql(env, sqls)](#module_@the-/db.helpers.execMysql)
    * [.execSqlite(env, sql, [options&#x3D;])](#module_@the-/db.helpers.execSqlite) ⇒ <code>Promise.&lt;\*&gt;</code>

<a name="module_@the-/db.helpers.binder"></a>

#### helpers.binder : <code>object</code>
**Kind**: static namespace of [<code>helpers</code>](#module_@the-/db.helpers)  
<a name="module_@the-/db.helpers.createTerminal"></a>

#### helpers.createTerminal(handler, [options&#x3D;]) ⇒ <code>Promise.&lt;\*&gt;</code>
**Kind**: static method of [<code>helpers</code>](#module_@the-/db.helpers)  

| Param |
| --- |
| handler | 
| [options=] | 

<a name="module_@the-/db.helpers.execMysql"></a>

#### helpers.execMysql(env, sqls)
**Kind**: static method of [<code>helpers</code>](#module_@the-/db.helpers)  

| Param |
| --- |
| env | 
| sqls | 

<a name="module_@the-/db.helpers.execSqlite"></a>

#### helpers.execSqlite(env, sql, [options&#x3D;]) ⇒ <code>Promise.&lt;\*&gt;</code>
**Kind**: static method of [<code>helpers</code>](#module_@the-/db.helpers)  

| Param |
| --- |
| env | 
| sql | 
| [options=] | 

<a name="module_@the-/db.mixins"></a>

### db.mixins : <code>object</code>
Mixin functions

**Kind**: static namespace of [<code>@the-/db</code>](#module_@the-/db)  
<a name="module_@the-/db.resources"></a>

### db.resources : <code>object</code>
Buildin resources

**Kind**: static namespace of [<code>@the-/db</code>](#module_@the-/db)  
<a name="module_@the-/db.create"></a>

### db.create(...args) ⇒ [<code>TheDB</code>](#module_@the-/db.TheDB)
Create a TheDB instance

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param | Type |
| --- | --- |
| ...args | <code>\*</code> | 

<a name="module_@the-/db.default"></a>

### db.default()
Alias of [create](#module_@the-/db.create)

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  
<a name="module_@the-/db.driverFromEnv"></a>

### db.driverFromEnv(env, options) ⇒ <code>\*</code>
Create driver from env

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param |
| --- |
| env | 
| options | 

<a name="module_@the-/db.execForEnv"></a>

### db.execForEnv(env, sql) ⇒ <code>Promise.&lt;\*&gt;</code>
Do exec for env

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param |
| --- |
| env | 
| sql | 

<a name="module_@the-/db.setupForEnv"></a>

### db.setupForEnv(env) ⇒ <code>Promise.&lt;\*&gt;</code>
Do setup for env

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param |
| --- |
| env | 

<a name="module_@the-/db.cascadeMix"></a>

### db.cascadeMix(Class) ⇒ <code>function</code>
**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  
**Returns**: <code>function</code> - Mixed Class  

| Param | Type |
| --- | --- |
| Class | <code>function</code> | 

<a name="module_@the-/db.cascadeMix..CascadeMixed"></a>

#### cascadeMix~CascadeMixed
**Kind**: inner class of [<code>cascadeMix</code>](#module_@the-/db.cascadeMix)  
<a name="module_@the-/db.cliMix"></a>

### db.cliMix(Class) ⇒ <code>\*</code>
Add cli methods

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param |
| --- |
| Class | 

<a name="module_@the-/db.cliMix..CliMixed"></a>

#### cliMix~CliMixed
**Kind**: inner class of [<code>cliMix</code>](#module_@the-/db.cliMix)  
<a name="module_@the-/db.migrateMix"></a>

### db.migrateMix() ⇒ <code>function</code>
Add migrate methods

**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Type |
| --- |
| <code>function</code> | 

<a name="module_@the-/db.refreshMix"></a>

### db.refreshMix(Class) ⇒ <code>function</code>
**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  
**Returns**: <code>function</code> - Mixed Class  

| Param | Type |
| --- | --- |
| Class | <code>function</code> | 


* [.refreshMix(Class)](#module_@the-/db.refreshMix) ⇒ <code>function</code>
    * [~RefreshMixed](#module_@the-/db.refreshMix..RefreshMixed)
        * [.requestToRefresh(entityRef)](#module_@the-/db.refreshMix..RefreshMixed+requestToRefresh)
        * [.startRefreshLoop(interval)](#module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop)
        * [.stopRefreshLoop()](#module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop)
        * [.waitToRefresh(entityRef, [options])](#module_@the-/db.refreshMix..RefreshMixed+waitToRefresh) ⇒ <code>Promise.&lt;boolean&gt;</code>

<a name="module_@the-/db.refreshMix..RefreshMixed"></a>

#### refreshMix~RefreshMixed
**Kind**: inner class of [<code>refreshMix</code>](#module_@the-/db.refreshMix)  

* [~RefreshMixed](#module_@the-/db.refreshMix..RefreshMixed)
    * [.requestToRefresh(entityRef)](#module_@the-/db.refreshMix..RefreshMixed+requestToRefresh)
    * [.startRefreshLoop(interval)](#module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop)
    * [.stopRefreshLoop()](#module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop)
    * [.waitToRefresh(entityRef, [options])](#module_@the-/db.refreshMix..RefreshMixed+waitToRefresh) ⇒ <code>Promise.&lt;boolean&gt;</code>

<a name="module_@the-/db.refreshMix..RefreshMixed+requestToRefresh"></a>

##### refreshMixed.requestToRefresh(entityRef)
Request to refresh entity

**Kind**: instance method of [<code>RefreshMixed</code>](#module_@the-/db.refreshMix..RefreshMixed)  

| Param | Type |
| --- | --- |
| entityRef | <code>string</code> | 

<a name="module_@the-/db.refreshMix..RefreshMixed+startRefreshLoop"></a>

##### refreshMixed.startRefreshLoop(interval)
Start refreshing loop

**Kind**: instance method of [<code>RefreshMixed</code>](#module_@the-/db.refreshMix..RefreshMixed)  

| Param | Type |
| --- | --- |
| interval | <code>number</code> | 

<a name="module_@the-/db.refreshMix..RefreshMixed+stopRefreshLoop"></a>

##### refreshMixed.stopRefreshLoop()
Stop refreshing loop

**Kind**: instance method of [<code>RefreshMixed</code>](#module_@the-/db.refreshMix..RefreshMixed)  
<a name="module_@the-/db.refreshMix..RefreshMixed+waitToRefresh"></a>

##### refreshMixed.waitToRefresh(entityRef, [options]) ⇒ <code>Promise.&lt;boolean&gt;</code>
Wait until refresh

**Kind**: instance method of [<code>RefreshMixed</code>](#module_@the-/db.refreshMix..RefreshMixed)  
**Returns**: <code>Promise.&lt;boolean&gt;</code> - - Full filled  

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| entityRef | <code>string</code> |  |  |
| [options] | <code>Object</code> | <code>{}</code> | Optional settings |

<a name="module_@the-/db.resourceMix"></a>

### db.resourceMix(Class) ⇒ <code>\*</code>
**Kind**: static method of [<code>@the-/db</code>](#module_@the-/db)  

| Param |
| --- |
| Class | 


* [.resourceMix(Class)](#module_@the-/db.resourceMix) ⇒ <code>\*</code>
    * [~ResourceMixed](#module_@the-/db.resourceMix..ResourceMixed)
        * [.assertResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+assertResource)
        * [.getResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+getResource) ⇒ <code>Object</code>
        * [.hasResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+hasResource) ⇒ <code>boolean</code>

<a name="module_@the-/db.resourceMix..ResourceMixed"></a>

#### resourceMix~ResourceMixed
**Kind**: inner class of [<code>resourceMix</code>](#module_@the-/db.resourceMix)  

* [~ResourceMixed](#module_@the-/db.resourceMix..ResourceMixed)
    * [.assertResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+assertResource)
    * [.getResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+getResource) ⇒ <code>Object</code>
    * [.hasResource(resourceName)](#module_@the-/db.resourceMix..ResourceMixed+hasResource) ⇒ <code>boolean</code>

<a name="module_@the-/db.resourceMix..ResourceMixed+assertResource"></a>

##### resourceMixed.assertResource(resourceName)
Check if resource exists

**Kind**: instance method of [<code>ResourceMixed</code>](#module_@the-/db.resourceMix..ResourceMixed)  
**Throws**:

- <code>Error</code> Resource not found error


| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db.resourceMix..ResourceMixed+getResource"></a>

##### resourceMixed.getResource(resourceName) ⇒ <code>Object</code>
Get resource with name

**Kind**: instance method of [<code>ResourceMixed</code>](#module_@the-/db.resourceMix..ResourceMixed)  
**Returns**: <code>Object</code> - Resource instance  

| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db.resourceMix..ResourceMixed+hasResource"></a>

##### resourceMixed.hasResource(resourceName) ⇒ <code>boolean</code>
Check if resource exists

**Kind**: instance method of [<code>ResourceMixed</code>](#module_@the-/db.resourceMix..ResourceMixed)  

| Param | Type |
| --- | --- |
| resourceName | <code>string</code> | 

<a name="module_@the-/db..MigrateMixed"></a>

### @the-/db~MigrateMixed
**Kind**: inner class of [<code>@the-/db</code>](#module_@the-/db)  
<a name="module_@the-/db..MigrateMixed+migrate"></a>

#### migrateMixed.migrate(handlers) ⇒ <code>Promise.&lt;?Object&gt;</code>
Run database migration

**Kind**: instance method of [<code>MigrateMixed</code>](#module_@the-/db..MigrateMixed)  
**Returns**: <code>Promise.&lt;?Object&gt;</code> - Migration result  

| Param | Type | Description |
| --- | --- | --- |
| handlers | <code>Object.&lt;string, function()&gt;</code> | Migration handler for each versions |

